// Copyright (c) 2013 Rice University
// This software is subject to the provisions of the GNU AFFERO GENERAL PUBLIC LICENSE Version 3.0 (AGPL).
// See LICENSE.txt for details.

/******************************************************
 * Custom psychology elements
 *
 * Most of the customizations are
 * `.note` elements with specific classes to create
 * the different styles of Feature elements:
 *
 * Everyday Connection, Dig Deeper, Link to Learning,
 * Connect the Concepts
 *
 ******************************************************/
.chapter .note {
  #content>#note>.style();

  > .title {
    #content>#note>#title>.style();
  }

  p { #content>#paragraph>.style(any; any; note); }

  .figure { #content>#figure>.style(any; any; note); }

  &.everyday-connection {
    #content>#note>.style('everyday-connection'; any);
  }
  &.dig-deeper {
    #content>#note>.style('dig-deeper'; any);
  }
  &.what-do-you-think {
    #content>#note>.style('what-do-you-think'; any);
  }
  &.connect-the-concepts {
    #content>#note>.style('connect-the-concepts'; any);
  }
  &.link-to-learning {
    #content>#note>.style('link-to-learning'; any);

    > .body {
      padding: 0px 10px;
    }
  }
  .blockquote blockquote {
    #content>#blockquote>.style(any; any; note);
  }

  .body > .title {
    padding: 0px 0px 10px 0px;
    font-weight: 700;
    font-size: 10pt;
    line-height: 13pt;
  }

  .figure {
    padding-bottom: 0;
    padding-top: 15px;
  }
  &.chapter-objectives {
    #content>#note>.style('chapter-objectives');
  }
}


/******************************************************
 * Preface
 ******************************************************/
.preface {
  > .titlepage h1.title {
    #part>#preface>#titlepage>.title();
  }

  .titlepage h2,
  .titlepage h3 {
    #part>#preface>#titlepage>.subtitle();
  }

  // Ask Derek/Phil about possibly using section mixin here, if not how to use #section
  // in Preface?  The lines below are some general settings from psychology.less for prefac
  // that can be consolidated here... or we can move into precalculus.
  > .section h2,
  > .section h3 {
    font-size: 11pt;
  }
  > .section h3 {
    text-transform: none;
  }
}



/********************************************************************
 * Styling for Chapter Titles
 ********************************************************************/

// Reset (ccap-precalculus.less)
div.book div.chapter > div.titlepage > div > div h1.title {
  // string-set and display: none are used to get rid of the "."
  // in the chapter titles, since the class "...-autogenerated" is
  // used for both the string "chapter" and the ".".
  span.cnx-gentext-autogenerated {
    // placed in slot - but precalc doesn't have skeleton entry for ":first-of-type"
  }
  span.cnx-gentext-autogenerated:first-of-type {
    string-set: cnx-chapter-string content();
  }
}

/******************************************************
 * Learning Objectives/Chapter Objectives
 ******************************************************/

.section > .titlepage .abstract {
  #part>#chapter>#learning-objectives>.style();
}


/******************************************************
 * Tables
 ******************************************************/

.table {
  .table-caption.caption {
    color: @red;
    font-size: 10pt;
    font-weight: 700 !important; // Override previously used important.
    line-height: 13pt;
    padding-left: 5px;
  }
  // @table-border is used with border-bottom in Precalculus, but the table
  // already has a bottom border. !important is used to override this.
  table tbody[valign=top]>tr>td { vertical-align: top; }

  table td {
    border-color: @orange !important; // td's have inline style=""
    font: 10pt/14pt @font-family-serif;
    padding: 5px 10px;
  }
  > caption, td {
    #content>#table>.cell();
  }
}


/********************************************************************
 * End of chapter customizations
 ********************************************************************/

 /* extraction into skeleton/slots partially finished. complete */

.cnx-eoc {
  &.summary {
    p:nth-of-type(1) {  margin-top: 0; }
    > div.section:nth-of-type(3) .title {
      padding-top: 0; // nth-of-type here is strange, but there is no nth-of-class, etc.
                      // The first div is a title, and the second is ".section .empty".
    }
  }

  &.review-questions {
    #part>#chapter-end>#review-questions>.style();
    > .title { #part>#chapter-end>#review-questions>#title>.style(); }
    p {
      text-align: left; //W&N does not want Review Questions justified.
    }
  }

  &.critical-thinking {
    #part>#chapter-end>#critical-thinking>.style();
    > .title { #part>#chapter-end>#critical-thinking>#title>.style(); }
  }

  &.personal-application {
    #part>#chapter-end>#personal-application>.style();
    > .title { #part>#chapter-end>#personal-application>#title>.style(); }
  }
}

// Turn off section numbering and title for eoc collations
.review-questions, .critical-thinking, .personal-application {
  > .section > .title { display: none; }
}

// Override must be applied from PreCalculus to view headers
.summary {
  > .section > .title { display: block; }
}

/* Squash references and solutions if they show up at the end of
   a chapter. They are special-cased and show up at the end of the book */
.cnx-eoc.references,
.cnx-eoc.cnx-solutions, {
  display: none;
}



/******************************************************
 * End-of-Book Index
 ******************************************************/

.index {
  .letter {
    #part>#book-end>#index>.letter();
  }
  h3 {
    #part>#book-end>#index>.style();
  }
}

// Fixes a bug due to precalculus rendering "." after
// solution numbers.
div.colophon.end-of-book-solutions .chapter-area a::after { content: ""; }

// The universal selector is being used in a section of precalculus that
// isn't refactored as of yet pending discussion.  After we decide we can fix
// this here and in history.
div.colophon.end-of-book-solutions .chapter-area a.chapter * {
  font-family: @font-family-serif;
  color: black;
  font-size: 10pt;
  font-weight: bold;
  margin: .5em 0em;
}
div.colophon.end-of-book-solutions {
> .chapter-area h2.title a.chapter {
      #part>#book-end>#end-of-book-solutions>#title>.style('chapter-area'; any);
    }
    > .chapter-area h2.title a.chapter span {
      #part>#book-end>#end-of-book-solutions>#title>.style('chapter-area'; any);
      display:inline;
    }
}

div.colophon.end-of-book-solutions .chapter-area a {
   font-family: @font-family-serif;
}

div.colophon.end-of-book-solutions .chapter-area h2 {
   margin-bottom: .5em;
}


/********************************************************************
 * Generic Elements
 ********************************************************************/

div.book > div.chapter .section{
  &.module {
      #part>#module>.style();
      >.section:last-child {
        margin-bottom: 0;
      }
    }
    &.empty {
      margin-bottom: 0;
    }
}

p,
.section > p {
  #content>#paragraph>.style(any);
}

// Styling for lists inside sections
.module > .section > div.orderedlist > ol.orderedlist,
.module > .section > div.itemizedlist > ul.itemizedlist {
  #content>#list>.item(any, any, section);
}


/******************************************************
 * Key Terms / Glossary
 ******************************************************/

// glossterm/no-emphasis doesn't occur in precalc for non-bold terms.
// Created first attempt at home here
em.glossterm span { display: none; }
em.glossterm span.emphasis { display: inline; } // Emphasized parts of key terms
.glossary .glossterm {
    #content>#glossary>.glossterm(any);
}

// For some reason with Psychology, it is generating dl dt::after which isn't
// being targeted as it is in preCalc (dt:after) This has been added to fix.
// This should be addressed in horizontal refactor of glossary across books.
.glossary {
// Remove ":"
  dl dt::after { #content>#glossary>.divider(); }
}

.glossary > .titlepage > div > div> .title, .cnx-eoc > .title > span {
  margin-top: initial;
  padding: initial;
}
/* ---------------------------------------------------
 * End of Book Solutions
 * ---------------------------------------------------
 */

// This snippet is an override to a part of the precalculus skeleton
// in which hasn't found a home.  Due to specificity the font has to
// be set on this elements to stop san-serif font from displaying.
// We will need to refactor precalc section into slot and fix here.
div.colophon.end-of-book-solutions {
  // Some miscellaneous stuff we will have to decide on
  .chapter-area {
    a {
      &.solution {
        font-family: @font-family-serif;
      }

      &.chapter * {
        font-family: @font-family-serif;
      }
    }
  }
}

/******************************************************
 * End of book Solutions sub-sections
 ******************************************************/
div.colophon.end-of-book-solutions .chapter-area {
  div.review-questions { #part>#book-end>#end-of-book-solutions>.style('review-questions'); }
  div.critical-thinking { #part>#book-end>#end-of-book-solutions>.style('critical-thinking'); }
}
/******************************************************
 * Equations
 ******************************************************/

// A very high specificity rule in precalculus-skeleton that deals with the
// numbering/unnumbering of equations bleeds through to psychology when equations
// are present.  Although in base we have #content>#equation>.label() to turn these
// off, using that slot in psychology doesn't produce any result.   We will need
// to address equations at the bottom of prealc-skeleton and update here when a
// slot solution is decided upon.  This is the only way to turn these off for now.
div.book > div.chapter > div.section div.equation > *:last-child::after { display: none; }


// Copyright (c) 2013 Rice University
// This software is subject to the provisions of the GNU AFFERO GENERAL PUBLIC LICENSE Version 3.0 (AGPL).
// See LICENSE.txt for details.
h2, h3, h4 {
  margin: initial;
  sup a {
    display:none;
  }
}
@kind: default;
@part: chapter;
@context: default;
div[class="note"] {
  #content>#note>.style(non-feature);
  > .title { #content>#note>#title>.style(non-feature); }
}
.note {
  // &.qa {
  //   @context: feature-qa;
  //   #content>#note>.style(qa);

  //   > .title {
  //     #content>#note>#title>.style(@kind; @part; @context);
  //   }
  //   // the paragraph inside body has to be specifically targeted here to remove top-margin. grr.
  //   >.body, .body > p {
  //     #content>#note>#body>.style(@kind; @part; @context);
  //   }

  //   > .body .figure .title { #content>#figure>#title>.style(any; any; @context); }
  // }
  // &.media {
  //   @context: feature-media;
  //   #content>#note>.style(media);

  //   .itemizedlist > .listitem {
  //     #content>#list>.item(@kind, @part, @context);
  //   }

  //   // Supress the extra url generated from base that is wrapped with parentheses
  //   .itemizedlist > .listitem .link.only-show-once {
  //     content: content();
  //   }
  // }
  // &.try {
  //   @context: feature-try;
  //   #content>#note>.style(try);
  //   div.itemizedlist, div.orderedlist {
  //     ul, ol {
  //       #content>#list>.style(any; try-it);
  //     }
  //  }
  //   > .title {
  //     #content>#note>#title>.style(@kind; @part; @context);
  //   }

  //   .exercise {
  //     #content>#exercise>.style(@kind; @part; @context);
  //     > .title { #content>#exercise>#title>.style(@kind; @part; @context); }

  //     .problem {
  //       #content>#problem>.style(@kind; @part; @context; exercise);
  //     }
  //     .solution {
  //       #content>#solution>.style(@kind; @part; @context; exercise);
  //     }
  //   }
  // }
}

/* -------------------------
 * Preface
 * -------------------------
 */
div.book div.preface {
  > .titlepage {
    #part>#preface>#titlepage>.style();
    h1.title { #part>#preface>#titlepage>.title(); }
  }

  > div.section {
    div.titlepage > div > div > h2 {
      #content>#section>#title>.style(any; preface);
    }

    > div.section {
      > div.titlepage > div > div > h3 {
        #content>#section>#title>.style(any; preface; section);
      }
    }
  }
}

.chapter > .introduction > .figure.splash {
  #content>#figure>.style('splash'; chapter);
}
/* -------------------------
 * Book Table of Contents
 * -------------------------
 */
.book > .toc {
  #part>#toc>.style();

  > .title {
    #part>#toc>#title>.style();
  }

  a {
    #part>#toc>#link>.style();
  }
}

/* -------------------------
 * Unit Page
 * -------------------------
 */
div.part > div.titlepage { display: none; }



/* -------------------------
 * Chapter Introduction
 * -------------------------
 */
.chapter > .introduction {
  >.title {
    #part>#introduction>#title>.style();
  }

  > .toc a {
    #part>#introduction>#chapter-outline>#entry>#title>.style();
  }

  // overide hyperlink medium blue color must be back and normal weight
  > .toc .toc-section .cnx-gentext-t {
    color: @black;
    font-weight: normal;
  }

  // Take away default colon display after number
  > .toc .toc-section .cnx-gentext-n:after {
    content: "";
  }


  /******************************************************************
   * Styling for Chapter Outline Box
   ******************************************************************/
  >.toc {
    #part>#introduction>#chapter-outline>.style();

    >.title {
      #part>#introduction>#chapter-outline>#title>.style();
    }
  }
}

/********************************************************************
 * Styling for Chapter Titles
 ********************************************************************/

div.book div.chapter > div.titlepage > div > div h1.title {
  #part>#chapter>#title>.style();
  span.cnx-gentext-n {
    #part>#chapter>#title>.number();
  }
  span.cnx-gentext-t {
    #part>#chapter>#title>.text();
    &::before {
      #part>#chapter>#title>.divider();
    }
  }
  span.cnx-gentext-autogenerated {
    #part>#chapter>#title>.label();
  }
}

/********************************************************************
 * Styling for Appendix
 ********************************************************************/
div.book > div.appendix > div.titlepage > div > div h1.title {
  #part>#book-end>#appendix>#title>.style();

  span.cnx-gentext-autogenerated:first-of-type {
    #part>#book-end>#appendix>#title>.label();
  }

  span.cnx-gentext-n {
    #part>#book-end>#appendix>#title>.number();
  }
  span.cnx-gentext-t {
    #part>#book-end>#appendix>#title>.text();
    &::before {
      #part>#book-end>#appendix>#title>.divider();
    }
  }
}

div.book > div.appendix > div.section {
  #content>#section>.style(any; appendix);
}

div.book > div.appendix .table {
  #utils>#pb>.inside(auto);
}

//appendix  section title
div.book > div.appendix > div.section > div.titlepage h2 {
  #content>#section>#title>.style(any; appendix);
  &::before {
    #content>#section>#title>.number(any; appendix);
  }
  span.cnx-gentext-t {
    #content>#section>#title>.text(any; appendix);
  }
  span.cnx-gentext-autogenerated:first-of-type {
    #content>#section>#title>.label(any; appendix);
  }
}

//appendix sub section title
div.book > div.appendix > div.section  > div.section > div.titlepage h3 {
  #content>#section>#title>.style(any; appendix; section);
  &::before {
    #content>#section>#title>.number(any; appendix; section);
  }
  span.cnx-gentext-t {
    #content>#section>#title>.text(any; appendix; section);
  }
  span.cnx-gentext-autogenerated:first-of-type {
    #content>#section>#title>.label(any; appendix; section);
  }
}

/********************************************************************
 * Styling for Module Titles
 ********************************************************************/
div.book div.chapter > div.section > div.titlepage h2 {
  #part>#module>#title>.style();

  &::before {
    #part>#module>#title>.number();
  }
  span.cnx-gentext-n { #part>#module>#title>.number(); }

  span.cnx-gentext-t {
    #part>#module>#title>.text();
    &::before { #part>#module>#title>.divider(); }
  }
}

/********************************************************************
 * Styling for Module Section/Subsection Titles
 ********************************************************************/
div.book div > div.section > div.section {
  #content>#section>.style(any; any);
  div.titlepage > div > div > h3 { #content>#section>#title>.style(any; any); }

  > div.section { // Sub-sections
    #content>#section>.style(any; any; section);
    div.titlepage > div > div > h4 { #content>#section>#title>.style(any; any; section); }
  }
}

/********************************************************************
 * Styling for Learning Objectives Box
 ********************************************************************/

.section > .titlepage {
  .abstract {
    &::before {
     #part>#chapter>#learning-objectives>#title>.style();
    }
    .itemizedlist > ul {
      #part>#chapter>#learning-objectives>#list>.style();
     }

    p { font-family: @font-family; margin: 1em 0em .75em 1em; }

    .itemizedlist > .listitem > p {
      margin: 0em .3em;
      display: inline;
      text-align: left;
    }


    // Special three-part numbering for Learning Objective chapter.section.learning-objectives
    .itemizedlist > .listitem {
      counter-increment: learning-objectives;
      display: block;

      &::before {
        content: "" " " counter(chapter, decimal) "." counter(section, decimal) "." counter(learning-objectives) " " "";
        color: @medium-blue;
        font-weight: bold;
      }
    }
  }
}

/********************************************************************
 * End of chapter customizations
 ********************************************************************/

// eoc solution number links color
.cnx-eoc > .solution > a.number { color: @medium-blue; }

.cnx-eoc {
  #part>#chapter-end>.style();

  > .title {
    #part>#chapter-end>#title>.style();
  }

  &.summary {
    #part>#chapter-end>#summary>.style();
    > .title { #part>#chapter-end>#summary>#title>.style(); }
    > .section .title > a { #part>#chapter-end>#summary>#title>.link(); }
    p:nth-of-type(1) { margin-top: 1em; }
  }

  &.key-equations {
    #part>#chapter-end>#key-equations>.style();
    > div.title { #part>#chapter-end>#key-equations>#title>.style(); }
    > div.section > div.body {
      div.table { counter-increment: none; }
      table { #content>#table>.style(any; chapter; chapter-end; key-equations); }
    }
  }

  // &.key-concepts {
  //   #part>#chapter-end>#key-concepts>.style();
  //   > div.title { #part>#chapter-end>#key-concepts>#title>.style(); }
  //   // There doesn't seem to be a way to handle subsection titles in namespace yet.
  //   // Targeting the link tag 'a' with layout change (margin, padding) doesn't work
  //   // and isn't a good practice.  It's a bit like putting margin and padding on h1, h2, etc.
  //   // Better to just let the container do the layout instead of the element.
  //   > .section > .title { #part>#chapter-end>#key-concepts>#title>.subtitle(); }

  //   > .section > .title > a { #part>#chapter-end>#key-concepts>#title>.link(); }
  // }

  // &.review-exercises {
  //   #part>#chapter-end>#review-exercises>.style();
  //   > .title {
  //     #part>#chapter-end>#review-exercises>#title>.style();
  //   }
  // }

  // &.practice-test {
  //   #part>#chapter-end>#practice-test>.style();
  //   > .title {
  //     #part>#chapter-end>#practice-test>#title>.style();
  //   }
  // }

  &.cnx-solutions {
    #content>#solution>.style(@kind; chapter);
    > .section .title > a { #content>#solution>#title>.link(); }
    p:nth-of-type(1) { margin-top: 1em; }
  }

  .problem ol {
    #content>#list>.style(any; any; problem; exercise);
  }
  .problem::before {
    #content>#problem>.number(@kind; chapter-end);
  }

  .empty { display: hidden; } // hide, but count, empty elements.

  .exercise div.body div.problem .figure { #content>#figure>.style(any; chapter-end; exercise); }
}

// Turn off section numbering and title for eoc collations
.review-exercises, .practice-test, .key-equations, .summary {
  > .section > .title { display: none; }
}





/* ---------------------------------------------------
 * End of Book Solutions
 * ---------------------------------------------------
 */
div.colophon.end-of-book-solutions {
  prince-text-replace: "Answer:" ""; //strip out "Answer:" eob solutions for print_pdf
  #part>#book-end>#end-of-book-solutions>.style();

  > .title {
    #part>#book-end>#end-of-book-solutions>#title>.style();
  }

  // Some miscellaneous stuff we will have to decide on
  div.chapter-area:first-of-type h2.title {
    margin-top: 0;
    padding-top: 0;
  }

  .chapter-area {
    #part>#book-end>#end-of-book-solutions>#chapter-area>.style();
    a.solution {
      color: black;
    }

    > h2.title a.chapter,
    > h2.title a.chapter span {
      #part>#book-end>#end-of-book-solutions>#title>.style('chapter-area');
    }
    > h2.title a.chapter {
      // Now that this is display: block it honors page break
      // rules from .chapter {}. Reset it.
      #utils>#pb>.before(avoid);
      #utils>#pb>.after(avoid);
    }
    > h2.title a.chapter span { display: inline; } // reset display: block for spans

    // > div.review-exercises::before {
    //   #part>#book-end>#end-of-book-solutions>#title>.style('review-exercises');
    // }
    // > div.practice-test::before {
    //   #part>#book-end>#end-of-book-solutions>#title>.style('practice-test');
    // }
    // > div.try {
    //   &::before { #part>#book-end>#end-of-book-solutions>#title>.style('try-it'); }
    //   div.solution > div.title a.solution::before {
    //     content: target-counter(attr(href), chapter) "." target-counter(attr(href), try);
    //   }
    // }
    // > div.section-exercises::before {
    //   #part>#book-end>#end-of-book-solutions>#title>.style('section-exercises');
    // }


    div.solution {
      #content>#solution>.style(@kind; book-end);

      > div.title {
        #content>#solution>#title>.style(@kind; book-end);
      }

      > div.body {
        div, p { display: inline; }
        div.mediaobject {
          display: block;
         #content>#image>.style(any; book-end; solution);
        }
        #content>#solution>#body>.style(@kind; book-end);
      }
      div.table table caption { #content>#table>#caption>.style(any; book-end; solution); }
    }
  }
}


/* ---------------------------------------------------
 * End of Book References
 * ---------------------------------------------------
 */
div.end-of-book-references {
  #part>#book-end>#end-of-book-references>.style();

  > .title {
    #part>#book-end>#end-of-book-references>#title>.style();
  }

  // As with .chapter-area in solutions above, we will have to
  // decide on what type of slot we wish to create.
  > .chapter-area {
    > .title {
      #part>#book-end>#end-of-book-references>#chapter-area>.style();
    }

    > .body > .section-area > .title { #part>#book-end>#end-of-book-references>#section-area>#title>.style(); }
    > .body > .section-area > .body p { #part>#book-end>#end-of-book-references>#reference>.style(); }

    > .body > p {
      text-indent: 0em;
      margin: .5em 0em;
      > a.link {
        color: @orange;
        font-weight: normal;
        text-decoration: underline;
      }
    }
  }
}


/* ---------------------------------------------------
 * Index
 * ---------------------------------------------------
 */
.index {
  #part>#book-end>#index>.style();

  > .title {
    #part>#book-end>#index>#title>.style();
  }

  // This is required to override ccap base without targetting both .title and .title h2.
  // The goal here is to make > .title h2 go away.
  > .title h2 {
    padding: 0;
    font-size: inherit;
  }

  h3.letter {
    #part>#book-end>#index>.letter();
  }
  h3.letter:first-of-type {
    margin-top: 0;
    padding-top: 0;
  }

  .index-term {
    #part>#book-end>#index>.term();
  }

  a {
    #part>#book-end>#index>.link();
  }
}

/********************************************************************
 * Generic Elements
 ********************************************************************/

h5 {
  #content>#heading>.style(h5);
}
h6 {
  #content>#heading>.style(h6);
}

// Parent level link style
a { #content>#link>.style(); }

body {
  #content>#body>.style(any);
}
.book > .cnx-title h1 {
  #part>#titlepage>#title>.style();
}
img { #content>#image>.style(any; any); }
p { #content>#paragraph>.style(any); }
img, figure, subfigure  { margin: 1em; }



/* ---------------------------------------------------
 * End of book Attributions and About Connexions
 * ---------------------------------------------------
 */
.colophon > h1.title {
  #part>#book-end>#colophon>.style();
}
.colophon p:first-of-type {
  margin-top: 0;
  padding-top: 0;
}

/******************************************************************************
 * Breakout of figure code into 3 sizes (large, medium, small) for left aligned figure text
 ******************************************************************************/



/* ---------------------------------------------------
 * Figures/Subfigures
 * ---------------------------------------------------
 */

// Updated points width for PreCalculus assets @150 dpi
@figure-width-medium: 351pt;  // Width of 3/4 size art
@figure-width-small:  234pt;  // Width of 1/2 size art

.figure {
  #content>#figure>.style();

  // size the surrounding container to the size of the image container to allow the
  // left justified alignment of the Figure numbering and associated caption
  // default width is (hero) full size @ 625px. Specifying no class or width defaults
  // to full size.

  // 3/4 size art
  &.medium {
    //width: @figure-width-medium;
  }

  // 1/2 size art
  &.small {
    //width: @figure-width-small;
  }

  > .body {
    #content>#figure>#body>.style(any; any);
  }

  > .title {
    #content>#figure>#title>.number(); // "Figure x.x..."
  }

  > .caption {
    &::before {
      display: none; // This is overridden in precalculus.less
                     // it exists for derived titles.
      #content>#figure>#title>.number(); // "Figure x.x..."
    }
    #content>#figure>#title>.style();
  }

  & img {
    #content>#image>.style(@kind; @part; figure);
  }
  & + p {
    #content>#paragraph>.style(any; any; figure);
  }

}

/******************************************************************************
 * Addition of .commentary selector styling for Analysis header in examples
 ******************************************************************************/
.example .exercise {
  .commentary > .title {
    #content>#commentary>#title>.style(@kind; @part; exercise; example);

  }
}


/* -------------------------
 * End of Section Exercise Styling
 * -------------------------
 */

// Headers are san-serif but the text of exercises are serif
.section .exercise {
  #content>#exercise>.style(@kind; @part; section);
}

.section.section-exercises {
  // here section-exercises is @kind, not @context.
  #content>#section>.style(section-exercises; @part);

  // Create Exercises Title above sections
  &::before {
    #content>#section>#title>.style(section-exercises; @part);
  }
  // turn off "Section Exercises" title
  > .titlepage {
    display: none;
  }
  .exercise {
    #content>#exercise>.style(@kind; @part; section-exercise);
  }

  .exercise > .title {
    #content>#exercise>#title>.style(@kind; @part; section-exercise);
  }

  .exercise .problem .figure { #content>#figure>.style(@kind; @part; problem; exercise; section-exercise); }

  // The end-of-section exercises should not display solutions
  // It will be either this if they wish to do a solutions manual, or we will
  // collate to end-of-book
  .exercise .solution { #content>#solution>.style(@kind; @part; exercise; section-exercise); }

  // turn off default display for exercises that displays "Exercise x.x"
  .exercise:not(.labeled) > .title > span:first-child:not(.labeled):before {
    display: none;
  }
}

/********************************************************************
 * Glossary
 ********************************************************************/
.glossary {
  #content>#glossary>.style();

  .title {
    #content>#glossary>#title>.style();
  }

  // Remove ":"
  dl dt::after { #content>#glossary>.divider(); }

  // Remove terms indentation
  dl { #content>#glossary>.dl(); }
}



/* -------------------------
 * Example Elements Styling and Numbering
 * -------------------------
 */
.chapter .example { #content>#example>.style(any); }
.example > .title {
  #content>#example>#title>.style(any);
}
.example > .title > * {
    font-size: 130%;
    font-weight: 500;
    color: #fff;
}
.example > .body { #content>#example>#body>.style(any); }

.example .solution { #content>#solution>.style(any; any; example); }

// This lengthy selector is required to override a display:none.
div.book div.chapter > div.section div.example div.exercise .solution {
  .table > table > caption::before {
    #content>#table>#caption>.style(any; any; solution; exercise; example);
  }
  .table { #content>#table>.style(any; any; solution; exercise; example); }

  .figure {
    #content>#figure>.style(any; any; solution; exercise; example);

  .body {
      text-align: left;
    }
  }

  .figure .title span.cnx-gentext-t::before {
    #content>#figure>#title>.number(any; any; solution; exercise; example);
  }
}
div.book div.chapter > div.section div.example div.exercise .problem {
  .table > table > caption::before {
    #content>#table>#caption>.style(any; any; problem; exercise; example);
  }
  .table {
    #content>#table>.style(any; any; problem; exercise; example);
  }
  .figure {
    #content>#figure>.style(any; any; problem; exercise; example);

    .body {
      text-align: left;
    }
  }
  .figure .title span.cnx-gentext-t::before {
    #content>#figure>#title>.number(any; any; problem; exercise; example);
  }
}
div.book div.chapter > div.section div.example div.exercise .commentary {
   .table > table > caption::before {
    #content>#table>#caption>.style(any; any; commentary; exercise; example);
  }
  .table {
    #content>#table>.style(any; any; commentary; exercise; example);
  }
  .figure {
    #content>#figure>.style(any; any; commentary; exercise; example);

    .body {
      text-align: left;
    }
  }
  .figure .title span.cnx-gentext-t::before {
    #content>#figure>#title>.number(any; any; commentary; exercise; example);
  }
}
// for examples that have a problem/solution structure that need numbered headings
.example .exercise {
  #content>#exercise>.style(any; any; example);

  .problem > .title {
    #content>#problem>#title>.style(any; any; exercise; example);
  }

  .solution > .title {
    #content>#solution>#title>.style(any; any; exercise; example);
  }

  .solution > .body {
    #content>#solution>#body>.style(any; any; exercise; example);
  }
  .solution > .body > a.target-figure {
    color: @orange;
  }
  .solution > .body > p:first-of-type {
    margin-top: 0;
  }
  .solution > .title > p {
    float: left;
  }
  .solution {
    ol,ul {
      #content>#list>.style(any; any; solution; exercise; example);
    }
  }
}

/******************************************************************************
 * Tables
 ******************************************************************************/

div.table {
  // First, reset div.table so it just goes away. Apply styling to the actual
  // table element.
  margin: 0 auto;
  padding: 0;
  border: none;

  // TODO: Investigate this. Figures in a table?
  .cnx-figure-horizontal .informalfigure .caption {
    text-align: center; //center subfigure caption
    * {
      font-weight: normal; //override strong tag
      font-family: @font-family-serif;
    }
  }

  table {
    #content>#table>.style(any; any);
    caption {
      #content>#table>#caption>.style(any; any);
      &::before {
        #content>#table>#caption>.number(any; any);
      }
    }
    caption + tbody > tr:first-child > td.tablecell {
      border-top: none;
    }
    thead { #content>#table>#head>.style(any; any); }
    tbody { #content>#table>#body>.style(any; any); }
    tr { #content>#table>#row>.style(any; any); }
    th { #content>#table>#header>.style(any; any); }
    td { #content>#table>#data>.style(any; any); }
    // Add styling for table entries that should render as table headers
    td.header { #content>#table>#data>.style('header'; any); }
    thead > tr:first-child {
      #content>#table>#header>#title>.style(any; any);
    }
  }
  //handle lists inside tables
ul.itemizedlist, ol.orderedlist {
    #content>#list>.style(any; any; table);
    > .listitem > p {
      #content>#paragraph>.style(any; any; list; table);
     }
  }

  // Special colored table...
  &.color {
    th { #content>#table>#header>.style(colored; any); }
    tr { #content>#table>#row>.style(colored; any); }
    tr td:first-child { background-color: @light-orange; width: 2.5in; font-weight: bold; }
  }
}

.cnx-figure-horizontal .informalfigure .caption {
  text-align: center; //center subfigure caption
  * {
    font-weight: normal; //override strong tag
    font-family: @font-family-serif;
  }
}

/* ---------------------------------------------------
 * Custom Equation (Non) Numbering
 * ---------------------------------------------------
 */

// To be able for us to have some equations numbered and some non-numbered, we have to use
// a special class: <equation class="non-numbered">  This structure below is legacy and used
// throughout all book from inception. Instead of turning all numbering off as in other books
// We simply use new non-numbered class here to turn off only those that manually need to.
// since .equation .label is being set as well and hidden (we have to address using this)
// instead of *:last-child::after (yikes).  For those that do display as numbered, need
// to be @orange and bold.
div.book,
div.book > div.part {
  > div.preface,
  > div.chapter,
  > div.appendix {

    /*
    > div.section div.equation.non-numbered > *:last-child::after {
      display: none;
    }
    */

    > div.section div.equation > *:last-child::after {
      color: @orange;
      font-weight: bold;
    }
  }
}


// Set all headings ragged-right, as per W&N request on 6/27
// in github issues #570, #578.
h1, h2, h3, h4, h5, h6 {
  text-align: left;
}

/* -------------------------
 * Lists
 * -------------------------
 */
div.itemizedlist, div.orderedlist {
  ul, ol {
    #content>#list>.style(any; any);
  }
}


/* -------------------------
 * Images in chapters
 * -------------------------
 */
 .chapter .mediaobject img { #content>#image>.style(any; chapter); }
 .end-of-book-solutions .mediaobject img { #content>#image>.style(any; book-end; solutions); }


/********************************************************************
 * SVG Color cascading.
 ********************************************************************/

// !important is used to override inline styles.

g {
  text { fill: currentColor !important; }
  line { stroke: currentColor !important; }
}


//end of precalculus


// Copyright (c) 2013 Rice University
// This software is subject to the provisions of the GNU AFFERO GENERAL PUBLIC LICENSE Version 3.0 (AGPL).
// See LICENSE.txt for details.

/******************************************************
 * Custom psychology elements
 *
 * Most of the customizations are
 * `.note` elements with specific classes to create
 * the different styles of Feature elements:
 *
 * Everyday Connection, Dig Deeper, Link to Learning,
 * Connect the Concepts
 *
 ******************************************************/
.chapter .note {
  #content>#note>.style();

  > .title {
    #content>#note>#title>.style();
  }

  p { #content>#paragraph>.style(any; any; note); }

  .figure { #content>#figure>.style(any; any; note); }

  // &.everyday-connection {
  //   #content>#note>.style('everyday-connection'; any);
  // }
  // &.dig-deeper {
  //   #content>#note>.style('dig-deeper'; any);
  // }
  // &.what-do-you-think {
  //   #content>#note>.style('what-do-you-think'; any);
  // }
  // &.connect-the-concepts {
  //   #content>#note>.style('connect-the-concepts'; any);
  // }
  &.link-to-learning {
    #content>#note>.style('link-to-learning'; any);

    > .body {
      padding: 0px 10px;
    }
  }
  .blockquote blockquote {
    #content>#blockquote>.style(any; any; note);
  }

  .body > .title {
    padding: 0px 0px 10px 0px;
    font-weight: 700;
    font-size: 10pt;
    line-height: 13pt;
  }

  .figure {
    padding-bottom: 0;
    padding-top: 15px;
  }
  &.chapter-objectives {
    #content>#note>.style('chapter-objectives');
  }
}


/******************************************************
 * Preface
 ******************************************************/
.preface {
  > .titlepage h1.title {
    #part>#preface>#titlepage>.title();
  }

  .titlepage h2,
  .titlepage h3 {
    #part>#preface>#titlepage>.subtitle();
  }

  // Ask Derek/Phil about possibly using section mixin here, if not how to use #section
  // in Preface?  The lines below are some general settings from psychology.less for prefac
  // that can be consolidated here... or we can move into precalculus.
  > .section h2,
  > .section h3 {
    font-size: 11pt;
  }
  > .section h3 {
    text-transform: none;
  }
}



/********************************************************************
 * Styling for Chapter Titles
 ********************************************************************/

// Reset (ccap-precalculus.less)
div.book div.chapter > div.titlepage > div > div h1.title {
  // string-set and display: none are used to get rid of the "."
  // in the chapter titles, since the class "...-autogenerated" is
  // used for both the string "chapter" and the ".".
  span.cnx-gentext-autogenerated {
    // placed in slot - but precalc doesn't have skeleton entry for ":first-of-type"
  }
  span.cnx-gentext-autogenerated:first-of-type {
    string-set: cnx-chapter-string content();
  }
}

/******************************************************
 * Learning Objectives/Chapter Objectives
 ******************************************************/

.section > .titlepage .abstract {
  #part>#chapter>#learning-objectives>.style();
}


/******************************************************
 * Tables
 ******************************************************/

.table {
  .table-caption.caption {
    color: @red;
    font-size: 10pt;
    font-weight: 700 !important; // Override previously used important.
    line-height: 13pt;
    padding-left: 5px;
  }
  // @table-border is used with border-bottom in Precalculus, but the table
  // already has a bottom border. !important is used to override this.
  table tbody[valign=top]>tr>td { vertical-align: top; }

  table td {
    border-color: @orange !important; // td's have inline style=""
    font: 10pt/14pt @font-family-serif;
    padding: 5px 10px;
  }
  > caption, td {
    #content>#table>.cell();
  }
}


/********************************************************************
 * End of chapter customizations
 ********************************************************************/

 /* extraction into skeleton/slots partially finished. complete */

.cnx-eoc {
  &.summary {
    p:nth-of-type(1) {  margin-top: 0; }
    > div.section:nth-of-type(3) .title {
      padding-top: 0; // nth-of-type here is strange, but there is no nth-of-class, etc.
                      // The first div is a title, and the second is ".section .empty".
    }

    .section:not(.empty) { #content>#section>.style(any; chapter; summary); }
  }

  &.review-questions {
    #part>#chapter-end>#review-questions>.style();
    > .title { #part>#chapter-end>#review-questions>#title>.style(); }
    p {
      text-align: left; //W&N does not want Review Questions justified.
    }
  }

  &.critical-thinking {
    #part>#chapter-end>#critical-thinking>.style();
    > .title { #part>#chapter-end>#critical-thinking>#title>.style(); }
  }

  &.personal-application {
    #part>#chapter-end>#personal-application>.style();
    > .title { #part>#chapter-end>#personal-application>#title>.style(); }
  }
}

// Turn off section numbering and title for eoc collations
.review-questions, .critical-thinking, .personal-application {
  > .section > .title { display: none; }
}

// Override must be applied from PreCalculus to view headers
.summary {
  > .section > .title { display: block; }
}

/* Squash references and solutions if they show up at the end of
   a chapter. They are special-cased and show up at the end of the book */
.cnx-eoc.references,
.cnx-eoc.cnx-solutions, {
  display: none;
}



/******************************************************
 * End-of-Book Index
 ******************************************************/

.index {
  .letter {
    #part>#book-end>#index>.letter();
  }
  h3 {
    #part>#book-end>#index>.style();
  }
}

// Fixes a bug due to precalculus rendering "." after
// solution numbers.
div.colophon.end-of-book-solutions .chapter-area a::after { content: ""; }

div.colophon.end-of-book-solutions {
> .chapter-area h2.title a.chapter {
      #part>#book-end>#end-of-book-solutions>#title>.style('chapter-area'; any);
    }
    > .chapter-area h2.title a.chapter span {
      #part>#book-end>#end-of-book-solutions>#title>.style('chapter-area'; any);
      display:inline;
    }
}

div.colophon.end-of-book-solutions .chapter-area a {
   font-family: @font-family-serif;
}

div.colophon.end-of-book-solutions .chapter-area h2 {
   margin-bottom: .5em;
}


/********************************************************************
 * Generic Elements
 ********************************************************************/

div.book > div.chapter .section, div.book > div.appendix {
  &.module {
      #part>#module>.style();
      >.section:last-child {
        margin-bottom: 0;
      }
      // this is a temporary fix to style sections that do not follow another  section- this applies to first sections in modules as well as h4 level sections
      p + .section  {
        margin-top: 24px;
      }
    }
    &.empty {
      margin-bottom: 0;
    }
}

p,
.section > p {
  #content>#paragraph>.style(any);
}

// Styling for lists inside sections
.module > .section > div.orderedlist > ol.orderedlist,
.module > .section > div.itemizedlist > ul.itemizedlist {
  #content>#list>.item(any, any, section);
}


/******************************************************
 * Key Terms / Glossary
 ******************************************************/

// glossterm/no-emphasis doesn't occur in precalc for non-bold terms.
// Created first attempt at home here
em.glossterm span { display: none; }
em.glossterm span.emphasis { display: inline; } // Emphasized parts of key terms
.glossary .glossterm {
    #content>#glossary>.glossterm(any);
}

// For some reason with Psychology, it is generating dl dt::after which isn't
// being targeted as it is in preCalc (dt:after) This has been added to fix.
// This should be addressed in horizontal refactor of glossary across books.
.glossary {
// Remove ":"
  dl dt::after { #content>#glossary>.divider(); }
}

.glossary > .titlepage > div > div> .title, .cnx-eoc > .title > span {
  margin-top: initial;
  padding: initial;
}
/* ---------------------------------------------------
 * End of Book Solutions
 * ---------------------------------------------------
 */

// This snippet is an override to a part of the precalculus skeleton
// in which hasn't found a home.  Due to specificity the font has to
// be set on this elements to stop san-serif font from displaying.
// We will need to refactor precalc section into slot and fix here.
div.colophon.end-of-book-solutions {
  // Some miscellaneous stuff we will have to decide on
  .chapter-area {
    a {
      &.solution {
        font-family: @font-family-serif;
      }

      &.chapter * {
        font-family: @font-family-serif;
      }
    }
  }
}

/******************************************************
 * End of book Solutions sub-sections
 ******************************************************/
div.colophon.end-of-book-solutions .chapter-area {
  div.review-questions { #part>#book-end>#end-of-book-solutions>.style('review-questions'); }
  div.critical-thinking { #part>#book-end>#end-of-book-solutions>.style('critical-thinking'); }
}
/******************************************************
 * Equations
 ******************************************************/

// A very high specificity rule in precalculus-skeleton that deals with the
// numbering/unnumbering of equations bleeds through to psychology when equations
// are present.  Although in base we have #content>#equation>.label() to turn these
// off, using that slot in psychology doesn't produce any result.   We will need
// to address equations at the bottom of prealc-skeleton and update here when a
// slot solution is decided upon.  This is the only way to turn these off for now.
div.book > div.chapter > div.section div.equation > *:last-child::after { display: none; }

//end of psychology

// Copyright (c) 2013 Rice University
// This software is subject to the provisions of the GNU AFFERO GENERAL PUBLIC LICENSE Version 3.0 (AGPL).
// See LICENSE.txt for details.


// Would #content>#note>#title>.style('sciences-interconnect'; any); work?
#book.attribution, .colophon { font-size: initial; }
.chapter .note {
  &.sciences-interconnect {
    #content>#note>.style('sciences-interconnect'; any);
    >.title {
      #content>#note>#title>.style('sciences-interconnect'; any);
    }
  }
  &.everyday-life {
    #content>#note>.style('everyday-life'; any);
    >.title {
      #content>#note>#title>.style('everyday-life'; any);
    }
  }
  &.chemist-portrait {
    #content>#note>.style('chemist-portrait'; any);
    >.title {
       #content>#note>#title>.style('chemist-portrait'; any);
    }
  }
  &.link-to-learning {
    #content>#note>.style('link-to-learning'; any);
    p {
      padding-left:107px;
    }
  }
}


/******************************************************
 * Preface
 ******************************************************/

 // We will need to convert this to slot in other books
.preface {
  > .section h2,
  > .section h3 {
    color: @dark-blue;
  }

  img {
    #content>#image>.style(any; preface);
  }
}


/******************************************************
 * Chapter Outline
 ******************************************************/

// Do we have a slot to target the actual li entries for .toc-section?
// Not really sure where this should live?  The margin entries are attached to li.toc-section
.chapter > .introduction > .toc > * > li {
    margin: .4em 0;
}


/******************************************************
 * Example
 ******************************************************/

// No slot for this in precalculus. For Chemistry, example titles need to be boldish
.example > .title > * {
  font-weight: 700;
}

.example > .body {
  > div.title {
    #content>#paragraph>#title>.style(any; any; example);
  }
  > div.title:first-of-type {
    #content>#paragraph>#title>.style('primary'; any; example);
  }
  div.note {
    #content>#note>.style('answer'; any; example);

    div.title { #content>#note>#title>.style('answer'; any; example); }
    div.body, div.body p { #content>#note>#body>.style('answer'; any; example); }
  }
}

/******************************************************
 * Step lists
 ******************************************************/
div.stepwise {
  ol { #content>#list>.style('step-list'; any); }
  ol li {
    #content>#list>.item('step-list'; any);

    p:first-of-type { display: inline; }
  }
  ol li::before { #content>#list>.number('step-list'; any); }
}

// Using this long selector to override the use of '*' in numbering base...
div.book div.chapter > div.section div.example div.exercise div.step-list ul li {
  #content>#list>.item('step-list'; any);
}

/******************************************************
 * List inside of a list
 ******************************************************/
 div.orderedlist div.itemizedlist ul {
  #content>#list>.style(any; any; list);
 }

/******************************************************
 * Ad-hoc text emphasis classes.
 * For now we have one red, and one green class.
 ******************************************************/
span.emphasis-one strong {
  font-weight: inherit;
  color: @red;
}
span.emphasis-two strong {
  font-weight: inherit;
  color: @green;
}
span.emphasis-leading-indent strong { content: "\00a0" content(); }

/******************************************************
 * Tables
 ******************************************************/

.table {
  > table > caption + tbody > tr:first-child > td.tablecell {
    border-top:1px solid @dark-blue;
  }
  &.column-header tbody td:first-child  {
    #content>#table>#data>.style('header'; any);
  }
  &:not(.unnumbered) table {
    tr:first-child > th:first-child  {
      #content>#table>#header>#title>.text(any; any);
    }
  }

  table .table-caption.caption {
    color: @black;
    font-weight: normal !important; //override strong tag
    font-family: @font-family-sans-serif;
    font-size: 9pt;
  }
   table thead > tr:first-child {
   #content>#table>#header>#title>.style(any; any);
  }
}


/******************************************************
 * EOC Customizations
 ******************************************************/
.cnx-eoc {
  &.exercises {
    #part>#chapter-end>#exercises>.style();
    > .title { #part>#chapter-end>#exercises>#title>.style(); }
    p {
      text-align: left; //W&N does not want Review Questions justified.
    }
    > .section > .title > a { #part>#chapter-end>#exercises>#title>.link(); }
    > .section > .body > .exercise { #content>#exercise>.style(any; any; exercises; chapter-end); }
  }
}
.cnx-eoc .section .title { padding-top: 0; }

// This section not completely refactored in PreCalc yet.  Everything across
// books will need to go into #chapter-ara slot
div.colophon.end-of-book-solutions .chapter-area {
  #part>#book-end>#end-of-book-solutions>#chapter-area>.style(any);
  // Solution child selector override from PreCalc
  div.solution {
    #content>#solution>.style(@kind; book-end);
      div.itemizedlist, div.orderedlist {
    ul, ol {
      #content>#list>.style(any; end-of-book-solutions; solution);
    }
  }
  }
}

/******************************************************
 * Appendix
 ******************************************************/

// Styling for customized Appendix
div.appendix  {
  div.titlepage > div > div h1.title {
    #part>#appendix>#title>.style();
     span.cnx-gentext-n {
      &::before {
        content: "Appendix ";
      }
      #part>#appendix>#title>.number();
     }

    span.cnx-gentext-t {
    &::before {
      #part>#appendix>#title>.divider();
    }
   #part>#appendix>#title>.text();
  }

    span.cnx-gentext-autogenerated {
      #part>#appendix>#title>.label();
    }
  }


  div.section>div.titlepage > div > div h2 {
     &::before {
      #part>#appendix>#section>#title>.number();
    }
    #part>#appendix>#section>#title>.style();
    span.cnx-gentext-n {
      display: none;
    }
    span.cnx-gentext-t {
      #part>#appendix>#section>#title>.text();
      &::before {
        #part>#appendix>#section>#title>.divider();
      }
    }
    span.cnx-gentext-autogenerated {
      #part>#appendix>#section>#title>.label();
    }
  }
}

/********************************************************************
 * Glossary
 ********************************************************************/
.glossary {
  #content>#glossary>.style(any; chapter);

  .title {
    #content>#glossary>#title>.style(any; chapter);
  }

  // Remove terms indentation
  dl { #content>#glossary>.dl(any; chapter); }

  // Term/definition divider, eg ":"
  dl dt::after { #content>#glossary>.divider(any; chapter); }

  dl dt { #content>#glossary>.term(any; chapter); }

  dl dd { #content>#glossary>.definition(any; chapter); }
}

/********************************************************************
 * Ad-hoc numbering
 ********************************************************************/

// Disable numbering for equations in EOB solutions and in an appendix.
div.colophon.end-of-book-solutions .chapter-area div.solution > div.body div span.label,
div.book > div.appendix > div.section div.equation > *:last-child::after {
  display: none;
}

//end chemistry
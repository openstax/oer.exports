// Copyright (c) 2013 Rice University
// This software is subject to the provisions of the GNU AFFERO GENERAL PUBLIC LICENSE Version 3.0 (AGPL).
// See LICENSE.txt for details.

@cnx-string-key-concepts-and-summary: "Key Concepts and Summary"; 


.x-section-title-font() {
  color: @dark-blue; 
  font-size: 17pt;
}

#part {
  #toc {
    #title {
      .style(...) {
        color: @dark-blue;
        border-bottom-color: @dark-blue;
        font-weight: bold;
      }
    }
    #link {
      .style(...) {
        color: @dark-blue;
        font-weight: bold;
      }
    }
  }
  #preface {
    #titlepage {
      .style(...) {
        padding-top: 1.5em;
      }
      .title(...) {
        color: @white;
        background-color: @dark-blue;
        margin: 0.5em 0;
        margin-bottom: 0;
        padding: 0.3em 0.5em;
        padding-left: .25em;
        font-size: 2.8em;
        font-weight: normal;
        text-transform: uppercase;
        border-bottom: none;
      }
      .subtitle() {
        color: @dark-blue;
      }
    }
  }
  #introduction {
    #title {
      .style(...) { display: none }
    }
    #chapter-outline {
      .style(...) { display: none; }
    }
  }
  #chapter {
    #title {
      // Use a mixin here since we need to override
      // psychology for each slot.
      .x-chapter-title-font() {
        text-align: left;
        color: @dark-blue;
        font: bold 34pt/34pt @font-family-sans-serif;
      }
      .style(...) {
        .x-chapter-title-font();
        padding-bottom: .25em;
      }
      .divider(...) {
        .x-chapter-title-font();
        content: "| ";
        color: @black;
      }
      .text(...) {
        .x-chapter-title-font();
        border-top: none;
        display: inline;
        padding-left: .25em !important; // !important used in psychology...
        padding-bottom: 1em;
      }
      .number(...) {
        .x-chapter-title-font();
        content: content(); // reset psychology content:;
      }
    }
    #learning-objectives {
      .style(...) {
        border-bottom: none;
      }
      #title {
        .style(...) { display: none; }
      }
    }
  }
  #module {
    #title {
      .style() {
        border-bottom: none;
        .x-section-title-font();
      }
      // Separate the section number and title with a pipe
      .divider() {
        .x-section-title-font();
        color: black;
        content: "| ";
      }
      .number() { .x-section-title-font(); }
      .text() { .x-section-title-font(); }
    }
  }
  #chapter-end {
    .style(...){
      .x-column-count(1);
    }
    #section{
      #title{
        .style(...){
          a{
            display: none;
          }
        }
      }
    }
    #summary{
      #title{
        .style(...){
          content: @cnx-string-key-concepts-and-summary ;         
        }
        .link(...){
          display:inline;
          color: @dark-blue;
        }
      }
    }
    #title {
      .style(...) {
        color: @dark-blue;
        font: normal normal 700 13pt/1em @font-family-sans-serif;
        border-bottom: none;
        text-transform: uppercase;
        span{
          font-size: 18px;
        }
      }
    }
    #critical-thinking{
      .style(){
        .x-column-count(2); 
        column-fill: balance;
        text-align: left;
        margin-bottom: 20px;
      }
      #title{
        .style(...){
          -webkit-column-span: all; 
          column-span: all;
        }
      }
    }
  }
  // End of Book Customizations
  #book-end {
    #end-of-book-solutions {
        .style(...) {
          font-weight: 500;
        }
      #title {
        .style() {
          color: @dark-blue;
          text-transform: uppercase;
          border: none;
        }
      }
    }
    #end-of-book-references {
      .style(...) { display: block; }
    }
    #appendix {
      #title {
        .style() {
          font-size: 34pt;
          font-weight: bold;
          color: @dark-blue;
          padding: 0;
          margin: 0;
          text-transform: none;
        }
        .number() {
          color: @dark-blue;
        }
        .text() {
          display: none;
        }
        .divider() {
          display: none;
        }
        .label() {
          display: inline;
        }
      }
    }
  }
  #index {
    #title {
      .style(...) {
        font-weight: 500;
      }
    }
  }
  // End of Book Attribution and About Connexions
  #colophon {
    .style(...) {
      font-weight: 500;
    }
  }
}

// Legacy .x-feature function from Anatomy text used 
// due to identical features parameterization
// TODO: This (and other feature macros) should be 
// moved to utils.
.x-feature (@color, @bg-color, @svg, @padding-top) {
  color: @color;
  font-family: @font-family;
  padding: 0.2em 1em;

  p:nth-of-type(2) {
    #utils>#pb>.before(avoid);
  }
  &::before {
    padding-top: @padding-top; //from the SVG files
    background-repeat: no-repeat;
    #utils>#pb>.after(avoid);
    background-color: white;
    content: "";
    display: block;
    // the following are tweaked so the overlays really do over lay
    margin-left: -1em;
    margin-right: -1em;
    margin-top: -0.05in;
  }

  background-color: @bg-color;
  &::before { background-image: url("ccap-economics/@{svg}.svg"); }

  > .title {
    font-size: large;
    margin-top: .6em;
    margin-bottom: .2em;
    padding: 0px .5em;
    color: black;
    border: none;
  }

  // Must apply padding to all elements in body not just blockquote and para, tables
  // are being stuffed inside features as well and must play nice with text alignment
  > .body {
    padding: 0px .8em;

    // W&N requests that all inline elements inside feature be sans-serif
    p, ol, li { font-family: @font-family; }
  }

  .figure {
    img { max-width: (@page-width - .25em); }
    > .title { font-size: 9.5pt; color: @dark-blue; }
  }
}

#content {
  #note {
    .style(...) {
      #utils>#pb>.inside(auto);
    }
    .style('bring-it-home'; chapter ) {
      .x-feature(@black, @gray, bring, 0.48in);
    }
    .style('clear-it-up'; chapter) {
      .x-feature(@black, @gray, clear, 0.53in);
    }
    .style('work-it-out'; chapter) {
      .x-feature(@black, @gray, work, 0.38in);
    }
    .style('link-it-up'; chapter) {
      .x-feature(@black, @gray, link, 0.38in);
    }
    .style('chapter-objectives'; introduction) {
      // We must use a background color here to stop Precalculus from assuming this is
      // a generic precalculus note and giving it blue background.
      background-color: @white;
      padding: 0;
      margin: 0;
      border-bottom: none;
    }

    #title {
      .style('bring-it-home'; chapter) {
        font-weight: bold;
        padding: 0px .5em;
        margin-top: 0.5em;
      }
      .style('chapter-objectives'; any) {
        font-size: x-large;
        color: @dark-blue;
        // Border must be removed from title due to Precalculus thinking this is generic
        // note.  Since manual chapter objectives must be a note, we must keep Precalc at bay.
        border: none;
        padding-left: 0;
      }
    }
  }
  #link {
    .style(...) {
      color: @dark-blue;
    }
  }
  #table {
    .style(any; any) {
      width: 100%;
      border: none;
      margin-top: 15px;
    }
    .style(any; preface) {
      margin: 0;
      border: none;
    }
    #caption {
      .style(any; any) {
        caption-side: bottom;
        border: none;
        color: @dark-blue;
      }
      .number(any; any){
        color: @dark-blue;;
      }
    }
    #head {
      .style(any; any) {
      }
    }
    #body {
      .style(any; any) {
        border-bottom: 1px solid @black;
      }
    }
    #row {
      .style(any; any) {
        border: none;
      }
    }
    #header {
      .style(any; any) {
        background-color: @light-blue;
        border: none;
        border-top: 3px solid @dark-blue !important; // !important is in ccap-base
        border-bottom: 3px solid @dark-blue !important;
        border-right: none;
      }
    }
    #data {
      .style(any; any) {
        border-color: @black!important;
        border-width: thin;
        border-bottom: 1px solid @black!important;

      }
      .style(any; preface) {
        padding: 5px;
      }
    }
  }
  #section {
    .style(any; preface) {
      #utils>#pb>.before(avoid);
      #utils>#pb>.after(always);
    }
    #title {
      .style(any; any) {
        .x-section-title-font();
        border-bottom: none;
        text-transform: none;
        font: bold 13pt/13pt @font-family-sans-serif;
        #utils>#pb>.before(auto);
      }
      .number(any; appendix) {
        display: none;
      }
    }
  }
  #list {
    .item(any; introduction; note; 'chapter-objectives') {
      margin-bottom: .5em;
    }
  }
  #figure {
    #title {
      .number(...) {
        color: @dark-blue;
      }
    }
  }
  #glossary {
    .style(...) {
      // Don't show the "Chapter X Review" header from PreCalc
      &::before {
        display: none;
      }
    }
    #title {
      .style(...) {
        /* Change "Glossary" to "Key Terms" */

        // Temp changes in place until we horizontally refactor glossary across books.
        color: @dark-blue !important;
        font-size: 12pt !important;
        text-transform: uppercase !important;
        border:none;
        margin-top: 0;
        padding-top: 0;
      }
    }
    .dt() {
      // prevent container from allowing meaning to wrap appropriately
      height: 15px;
    }
    .dl() {
      margin: 1em 0;
      text-align: left;
    }
    .glossterm(any) {
      font: normal normal 700 10pt/13pt @font-family-serif;

      &.no-emphasis {
        font-weight: 400;
      }
    }
  }
}

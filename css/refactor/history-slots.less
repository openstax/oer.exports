// Copyright (c) 2013 Rice University
// This software is subject to the provisions of the GNU AFFERO GENERAL PUBLIC LICENSE Version 3.0 (AGPL).
// See LICENSE.txt for details.

.x-header-spacing() {
  margin-top: 17.333px;
  padding-bottom: 0;
  margin-bottom: 6.6px;
}

#index {
  .term() {
    padding-bottom: 0;
  }
}
#part {
  .title(chapter) {
    font: @font-family-sans-serif;
    border: none;
    margin-bottom: .5em;
  }

  #preface {
    #titlepage {
      .style(...) {}
      .title(...) {
        font-weight: medium;
        border: none;
      }
    }
  }
  #introduction {
    #title {
      .style(...) {
        color: @red;
        border-bottom: none;
        font-size: 14pt;
        line-height: 14pt;
      }
    }
    #splash-figure {
      .image(chapter) {
        // W&N has requested to be able to place splash "at size" for this text
        // Some splash imagery won't be full width. Leaving up to container.
        // overriding base-slots
        width: auto;
      }
    }
  }
  #toc {
    .style(...) {
      border: none;
    }
    #title {
      .style(...) {
        background-color: initial;
        font: bold normal 11pt/1em @font-family-sans-serif;
        color: @red;
        border-bottom: 1px solid @red;
        text-align: left;
      }
    }
    #link {
      .style(...) {
        color: @red;
      }
    }
    #entry {
      #title { // "1.1"
        .style(...) {
          color: black;
        }
      }
    }
  }
  #chapter {
    #title {
      .style() {
        color: @red;
        border: none;
        font-size: 14pt;
      }
      .text() {
        border: none;
        border-top-style: none;
        margin: 0;
        padding-left: 0;
        padding-top: 8px;
        padding-bottom: 2px;
        color: @dark-blue;
      }
      .number() {
        font-size: 14pt;
        text-transform: uppercase;
      }
    }
    #learning-objectives {
      .style(...) {
        background-color: @light-gray-40;
        border-top: 1px solid @light-blue;
        border-bottom: none;
        padding: 1em;
      }
      #title {
        .style(...) {
          display: none; // Do not display "Learning Objectives"
        }
      }
    }
  }

  #module {
    #title {
      .style() {
        border: none;
        color: @red;
        font: 700 normal normal 11pt/13pt @font-family-sans-serif;
        margin-bottom: .5em;
        text-transform: none;
      }
      .divider() {}
      .number() {}
      .text() {}
    }
  }
  #glossary {
    .term(chapter) {
      font: 400 10pt/13pt @font-family-serif;
    }
    .definition(chapter) {
      padding-left: 0em;
      font: 400 10pt/13pt @font-family-serif;

    }
    #title {
      .style(chapter) {
        color: @red;
        font-size: 17px !important;
        text-transform: none;
        .x-header-spacing();
      }
    }
  }

  // End of chapter section slots
  // These sections #summary, #review-questions, and #critical-thinking
  // can be refactored to use new factory mixin later. Leaving for now.
  #chapter-end{
    .style(...) {}

    #summary {
      .style(...) {
        margin-top: 0;
      }
      #title {
        .style(...) {
          content: "Summary";
          color: @red;
          font-size: 17px;
          font-weight: bold;
          border: none;
          .x-header-spacing();
        }
        .subtitle(...) {
          display: block;
          padding-bottom: 0;
        }
      }
    }
    #review-questions {
      .style(...) {
        // These properties are needed to vertically align
        // and evenly distribute questions in (2) two columns.
        // These directives exist in anatomy/biology eoc sections
        // We will need to extract them into a helper mixin later
        // i.e.  eoc-utils.less possibly.
        column-width: auto;
        column-fill: balance;
        column-break-inside: auto;
        text-align: left;
      }

      #title {
        .style(...) {
          color: @red;
          font-size: 17px;
          font-weight: bold;
          border: none;
          padding-left: 0;
          padding-bottom: 0;
          .x-header-spacing();
        }
      }
    }
    #critical-thinking {
      .style(...) {}

      #title {
        .style(...) {
          color: @red;
          font-size: 17px;
          font-weight: bold;
          border: none;
          .x-header-spacing();
        }
      }
    }
  }

  // End of Book Customizations
  #book-end {
    // End of Book solutions
    #end-of-book-solutions {
      .style(...) {
        column-count: 1;
      }
      #title {
        .style(...) {
          column-span: all;
          color: @red;
          font-size: 18pt;
          text-transform: none;
          border: none;
          margin-left: 0;
          .x-header-spacing();
        }
      }
    }

    // End of book references
    #end-of-book-references {
      .style(...) { display: none; }
    }

    #index {
      .style(...) {}

      #title {
        .style(...) {
          color: @red;
          border: none;
          text-transform: none;
          font-weight: 700;
          .x-header-spacing();
        }
      }
      .term(...) {}
      .link(...) {
        color: @red;
      }
    }
    // End of Book Attribution and About Connexions
    #colophon {
      .style(...) {
        color: @red;
        border: none;
        font-weight: 500;
      }
    }
  }
}

.x-history-feature(@left-color, @header-text) {
  border-left: 2.5em solid @left-color;
  &::before {
    background-color: @light-gray;
    border-bottom: 1px solid @orange;
    content: @header-text;
    text-transform: uppercase;
    width: 100%;
    padding: .5em 0 .5em 0; // Center text vertically
    display: block;
    text-align: center;
    font: normal bold 14pt/1em @font-family-sans-serif;
    color: @dark-blue;
  }

  > .body, > .title {
    margin-right: 20px;
    padding: 5px 0 0 20px;
  }
  > .title {
    font: italic bold 14pt/17pt @font-family-serif;
    text-align: left;

    span:first-of-type::before {
      background-image: url("ccap-history/feature-title.svg");
      background-repeat: no-repeat;
      background-position: center left;
      content: "";
      padding-right: 1.2em;
    }
  }
  > .body, > .body p {
    font: normal normal 9pt/12pt @font-family-sans-serif;
  }
}

#content {
  #note {
    .style(...) {
      #utils>#pb>.inside(avoid);
      padding: 0;
    }
    #blockquote {
      .style(){
       margin-left: 0;
       margin-right: 0;
      }
    }
    .style('my-story'; chapter) {
      .x-history-feature(@dark-blue, @cnx-string-my-story);
    }
    .style('defining-american'; chapter) {
      .x-history-feature(@orange, @cnx-string-defining-american);
    }
    .style('americana'; chapter) {
      .x-history-feature(@red, @cnx-string-americana);
    }
    .style('click-and-explore'; chapter) {
      background-color: @yellow-35;
      margin-bottom: 2.5em;


      //clearfix
      > .body::after {
        content: "";
        display: table;
        clear: both;
      }
      .mediaobject {
        float: left;
        width: @qr;
        margin-right: 1em;
        img {
          margin: 0;
          width: @qr;
          height: @qr;
        }
      }
    }
    #body {
      .style('click-and-explore'; chapter) {
        padding: 35px 20px 20px 20px;
        font: normal normal 9pt/12pt @font-family-sans-serif;
        text-align: left;
      }
    }
    #title {
      .style(non-feature) {
        border: none;
      }
      .style('click-and-explore'; chapter) {
        position: relative;
        top: 20px;
        border-top: 3px solid @orange;
        border-bottom: 3px solid @orange;
        display: block;
        height: 30px;
        padding-top: .3em;
        content: @cnx-string-click-and-explore;
        background: @dark-blue;
        color: @yellow-50;
        text-align: center;
        font: bold normal 16pt/1em @font-family-serif;
      }
    }
  }
  #blockquote {
    .style(...) {
      font-family: 10pt/13pt @font-family;
      color: black;
      font-size: inherit;
      margin-top: inherit;
      margin-bottom: inherit;
      line-height: inherit;
    }
  }
  #heading {
/*
    // W&N wishes capitalize/no-capitalize h2/h3 in markup
    .style(h2, ...) {
      font-size: 11pt;
      text-transform: none;
    }
    .style(h3, ...) {
      font-size: 11pt;
      text-transform: none;
    }
*/
  }
  #section {
    #abstract { //learning objectives
      .style(...) {
        border: none;
        border-style: none;
        border-top: 1px solid @light-blue;
        background-color: @light-gray-40;
        padding: 1em 1em 0 1em;
      }
      #title {
        .style(...) {
          display: none;
        }
      }
      .list(...) {
        padding-left: 12pt;
      }
    }
    #title {
      .style(any; preface) { color: @dark-blue; }
      .style(any; preface; section) {
        color: @dark-blue;
        text-transform: none;
        font-size: 11pt;
        line-height: 13pt;
      }
      .style(any; any;) {
        color: @dark-blue;
        text-transform: none;
        font-size: 11pt;
        line-height: 13pt;
        margin: 0.5em 0em;
        margin-top: 1.5em;
      }
      // H4
      .style(any; any; section) {
        color: @dark-blue;
        text-transform: none;
        font-size: 11pt;
        line-height: 13pt;
        margin: 0.5em 0em;

      }

    }
  }
   // Parent level link styling
  #link {
    .style(...) {
      color: @red;
    }
  }
  #table {
    .style(any; any) {
      background-color: @yellow-35;
      border: none;
    }
    // Tables used in Preface must have no background.
    .style(any; preface) {
      background: none;
      margin: 0;
      border: none;
    }
    #caption {
      .style(any; any) {
        background-color: @yellow-35;
        border-style: none;
        border-bottom: 1px solid @orange;
        border-bottom-style: solid;
      }
    }
  }
  #figure {
    .style(...) {}
    .style('timeline'; any) {
      /* The timeline figure will appear in first module after
      introduction and must snap to the bottom of page.
      Coded to function this way:

      1. If there is right amount of content on page 1, and figure
      will fit it will snap to bottom of page as designed.

      2. If there is too much content timeline will snap to the
      bottom of the next page.  Working with footnote as well.

      We cannot use display:block; here, because using any type
      of float causes an inline element to render as a block (inline-block).
      This simple rule below gets us where we need to be.
      */

      // a little space on bottom in case of footnote
      padding-bottom: 1em;
      // snap figure to bottom of page
      float: bottom;

      // remove padding so figure ID caption are snug against image
      .body { padding: 0; }
    }
    .caption(...) {
      font-size: 9pt;
      color: black;
      text-align: left;
      font-weight: normal;
    }
    #title {
      .style(...) {
        display: inline;
        font-size: 9pt;
        font-weight: bold;
        color: @red;
        text-align: left;
      }
      .number(...) {}
    }
  }
}





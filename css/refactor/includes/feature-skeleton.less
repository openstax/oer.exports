/******************************************************
 * Mathematics Features
 *
 * Features from Pre-Calculus
 *   How To
 * Features from Calculus
 *   Theorem
 *   Student Project
 *   Checkpoint
 *   Media-2 (Alternative Media style)
 *   Definition
 *   Problem Solving
 * Features from Basic Mathematics
 *****************************************************/

 @kind: any;
 @part: any;


div[class="note"] {
  #content>#note>.style(non-feature);
  > .title { #content>#note>#title>.style(non-feature); }
}
.note {
  &.qa {
    @context: feature-qa;
    #content>#note>.style(qa);

    > .title {
      #content>#note>#title>.style(@kind; @part; @context);
    }
    // the paragraph inside body has to be specifically targeted here to remove top-margin. grr.
    >.body, .body > p {
      #content>#note>#body>.style(@kind; @part; @context);
    }

    > .body .figure .title { #content>#figure>#title>.style(any; any; @context); }
  }
  &.media {
    @context: feature-media;
    #content>#note>.style(media);

    .itemizedlist > .listitem {
      #content>#list>.item(@kind, @part, @context);
    }

    // Supress the extra url generated from base that is wrapped with parentheses
    .itemizedlist > .listitem .link.only-show-once {
      content: content();
    }
  }
  &.try {
    @context: feature-try;
    #content>#note>.style(try);
    div.itemizedlist, div.orderedlist {
      ul, ol {
        #content>#list>.style(any; try-it);
      }
   }
    > .title {
      #content>#note>#title>.style(@kind; @part; @context);
    }

    .exercise {
      #content>#exercise>.style(@kind; @part; @context);
      > .title { #content>#exercise>#title>.style(@kind; @part; @context); }

      .problem {
        #content>#problem>.style(@kind; @part; @context; exercise);
      }
      .solution {
        #content>#solution>.style(@kind; @part; @context; exercise);
      }
    }
  }

  &.howto {
    #content>#note>.style(howto);
  }
  &.howto.emphasized {
    #content>#note>.style(emphasized; howto);
  }
  &.theorem {
    #content>#note>.style(non-feature);
    > .title { #content>#note>#title>.style(non-feature); }
  }
  &.project {
    @context: student-project;
    #content>#note>.style(@context);

    > .title { #content>#note>#title>.style(@kind; @part; @context); }
  }
  &.checkpoint {
    #content>#note>.style(checkpoint);
  }
  &.quick-check {
    #content>#note>.style(quick-check);
  }
  &.quick-check.emphasized {
    #content>#note>.style(emphasized; quick-check);
  }
  &.quick-check,
  &.checkpoint,
  &.check-understanding {
    @context: feature-try;
    div.itemizedlist, div.orderedlist {
      ul, ol {
        #content>#list>.style(any; try-it);
      }
    }
    > .title {
      #content>#note>#title>.style(@kind; @part; @context);
    }

    .exercise {
      #content>#exercise>.style(@kind; @part; @context);
      > .title { #content>#exercise>#title>.style(@kind; @part; @context); }

      .problem {
        #content>#problem>.style(@kind; @part; @context; exercise);
      }
      .solution {
        #content>#solution>.style(@kind; @part; @context; exercise);
      }
    }
  }
  // Fix problem offset inside emphasized versions of quick check, checkpoint and check your understanding.
  &.quick-check,
  &.checkpoint,
  &.check-understanding {
    &.emphasized {
      > .title {
        padding-left: 2px;
      }
      > .title::before {
        display: block;
        padding-top: 6px;
      }
      .exercise .problem { margin-left: 2px; }
    }
  }
  &.media-2 {
    @context: feature-media;
    #content>#note>.style(media-2);

    .itemizedlist > .listitem {
      #content>#list>.item(@kind, @part, @context);
    }

    // Supress the extra url generated from base that is wrapped with parentheses
    .itemizedlist > .listitem .link.only-show-once {
      content: content();
    }
  }
  &.definition {
    @context: definition;
    #content>#note>.style(non-feature);
    > .title { #content>#note>#title>.style(non-feature); }
    > .title::before { #content>#note>#title>.style(@kind; @part; @context); }
    > .title span { display: none; }
  }
  &.problem-solving {
    @context: problem-solving;
    #content>#note>.style(problem-solving);
    > .title { #content>#note>#title>.style(@kind; @part; @context); }
  }
  &.be-prepared {
    #content>#note>.style(be-prepared);
    > .title {
      #content>#note>#title>.style(be-prepared); }
    > .title::before {
      content: "Be Prepared!";
    }
    > .body { padding: 0 1em; }
    .exercise {
      @context: be-prepared;
      #content>#exercise>.style(@kind; @part; @context);
      > .title { #content>#exercise>#title>.style(@kind; @part; @context); }
      > .body { #content>#exercise>#body>.style(@kind; @part; @context); }

      .problem {
        #content>#problem>.style(@kind; @part; @context; exercise);
        > .title { #content>#problem>#title>.style(@kind; @part; @context; exercise); }
        > .body {
          #content>#problem>#body>.style(@kind; @part; @context; exercise);
          p { #content>#paragraph>.style(@kind; @part; @context; exercise; problem); }
        }
      }
      .solution {
        #content>#solution>.style(@kind; @part; @context; exercise);
      }

      &:last-of-type {
        margin-bottom: 0;
      }
    }
  }
}
